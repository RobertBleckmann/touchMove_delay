{"ast":null,"code":"import { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport var EventType;\n(function (EventType) {\n  EventType[EventType[\"PointerEvent\"] = 0] = \"PointerEvent\";\n  EventType[EventType[\"TouchEvent\"] = 1] = \"TouchEvent\";\n})(EventType || (EventType = {}));\nexport class AppComponent {\n  constructor() {\n    this.EventType = EventType;\n    this.pointerActive = false;\n    this.activeEventType$$ = new Subject();\n  }\n  ngOnInit() {\n    this.activeEventType$$.asObservable().subscribe(eventType => {\n      console.log('sub', eventType);\n      eventType === EventType.PointerEvent ? this.addPointerEventListeners() : this.addTouchEventListeners();\n    });\n  }\n  ngOnDestroy() {\n    this.activeEventType$$.unsubscribe();\n  }\n  ngAfterViewInit() {\n    this.canvas = document.querySelector('#Canvas');\n    this.canvas2d = this.canvas.getContext('2d');\n    this.canvas.width = window.innerWidth;\n    this.canvas.height = window.innerHeight;\n  }\n  addPointerEventListeners() {\n    this.removeAllEventListeners();\n    document.addEventListener('pointerdown', event => {\n      this.pointerActive = true;\n      this.setStartOrEndPoint(event.x, event.y, 'red');\n    });\n    document.addEventListener('pointermove', event => {\n      if (this.pointerActive) {\n        console.log('pointer move', event.x, event.y);\n        this.drawOnCanvas(event.x, event.y, 'green');\n      }\n    });\n    document.addEventListener('pointerup', event => {\n      this.pointerActive = false;\n      this.setStartOrEndPoint(event.x, event.y, 'blue');\n    });\n  }\n  addTouchEventListeners() {\n    this.removeAllEventListeners();\n    document.addEventListener('touchstart', event => {\n      event.preventDefault();\n      this.setStartOrEndPoint(event.touches[0].clientX, event.touches[0].clientY, 'red');\n    });\n    document.addEventListener('touchmove', event => {\n      event.preventDefault();\n      console.log('touchmove');\n      this.drawOnCanvas(event.touches[0].clientX, event.touches[0].clientY, 'green');\n    });\n    document.addEventListener('touchend', event => {\n      this.setStartOrEndPoint(this.lastCoordinates.lastX, this.lastCoordinates.lastY, 'blue');\n    });\n  }\n  removeAllEventListeners() {\n    document.removeAllListeners();\n  }\n  setStartOrEndPoint(x, y, color) {\n    this.canvas2d.fillStyle = color;\n    this.canvas2d.fillRect(x, y, 3, 3);\n    this.lastCoordinates = {\n      lastX: x,\n      lastY: y\n    };\n  }\n  drawOnCanvas(x, y, color) {\n    this.canvas2d.beginPath();\n    this.canvas2d.moveTo(this.lastCoordinates.lastX, this.lastCoordinates.lastY);\n    this.canvas2d.lineTo(x, y);\n    this.canvas2d.strokeStyle = '#000000';\n    this.canvas2d.stroke();\n    this.lastCoordinates = {\n      lastX: x,\n      lastY: y\n    };\n  }\n  static #_ = this.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)();\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 6,\n    vars: 0,\n    consts: [[3, \"click\"], [\"id\", \"Canvas\", 2, \"border\", \"1px solid grey\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_0_listener() {\n          return ctx.activeEventType$$.next(ctx.EventType.PointerEvent);\n        });\n        i0.ɵɵtext(1, \" PointerEvents\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_2_listener() {\n          return ctx.activeEventType$$.next(ctx.EventType.TouchEvent);\n        });\n        i0.ɵɵtext(3, \" TouchEvents\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"br\")(5, \"canvas\", 1);\n      }\n    },\n    styles: [\"canvas[_ngcontent-%COMP%] {\\n  display: block;\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFjO0FBQ2hCIiwic291cmNlc0NvbnRlbnQiOlsiY2FudmFzIHtcclxuICBkaXNwbGF5OiBibG9jaztcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"names":["Subject","EventType","AppComponent","constructor","pointerActive","activeEventType$$","ngOnInit","asObservable","subscribe","eventType","console","log","PointerEvent","addPointerEventListeners","addTouchEventListeners","ngOnDestroy","unsubscribe","ngAfterViewInit","canvas","document","querySelector","canvas2d","getContext","width","window","innerWidth","height","innerHeight","removeAllEventListeners","addEventListener","event","setStartOrEndPoint","x","y","drawOnCanvas","preventDefault","touches","clientX","clientY","lastCoordinates","lastX","lastY","removeAllListeners","color","fillStyle","fillRect","beginPath","moveTo","lineTo","strokeStyle","stroke","_","_2","selectors","decls","vars","consts","template","AppComponent_Template","rf","ctx","i0","ɵɵelementStart","ɵɵlistener","AppComponent_Template_button_click_0_listener","next","ɵɵtext","ɵɵelementEnd","AppComponent_Template_button_click_2_listener","TouchEvent","ɵɵelement"],"sources":["C:\\Workspace\\touchMove_delay\\src\\app\\app.component.ts","C:\\Workspace\\touchMove_delay\\src\\app\\app.component.html"],"sourcesContent":["import {Component, OnDestroy, OnInit} from '@angular/core';\r\nimport {Subject} from 'rxjs';\r\n\r\nexport enum EventType {\r\n  PointerEvent,\r\n  TouchEvent,\r\n}\r\n\r\nexport interface LastCoordinates {\r\n  lastX: number;\r\n  lastY: number;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.css'],\r\n})\r\nexport class AppComponent implements OnInit, OnDestroy {\r\n  public EventType = EventType;\r\n  private pointerActive: boolean = false;\r\n  public activeEventType$$: Subject<EventType> = new Subject<EventType>();\r\n\r\n  private canvas: HTMLCanvasElement;\r\n  private canvas2d;\r\n\r\n  private lastCoordinates: LastCoordinates;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {\r\n    this.activeEventType$$.asObservable().subscribe((eventType: EventType) => {\r\n      console.log('sub', eventType);\r\n      eventType === EventType.PointerEvent\r\n        ? this.addPointerEventListeners()\r\n        : this.addTouchEventListeners();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.activeEventType$$.unsubscribe();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.canvas = document.querySelector('#Canvas');\r\n    this.canvas2d = this.canvas.getContext('2d');\r\n    this.canvas.width = window.innerWidth;\r\n    this.canvas.height = window.innerHeight;\r\n  }\r\n\r\n  private addPointerEventListeners(): void {\r\n    this.removeAllEventListeners();\r\n    document.addEventListener('pointerdown', (event: PointerEvent) => {\r\n      this.pointerActive = true;\r\n      this.setStartOrEndPoint(event.x, event.y, 'red');\r\n    });\r\n\r\n    document.addEventListener('pointermove', (event: PointerEvent) => {\r\n      if (this.pointerActive) {\r\n        console.log('pointer move', event.x, event.y);\r\n        this.drawOnCanvas(event.x, event.y, 'green');\r\n      }\r\n    });\r\n\r\n    document.addEventListener('pointerup', (event: PointerEvent) => {\r\n      this.pointerActive = false;\r\n      this.setStartOrEndPoint(event.x, event.y, 'blue');\r\n    });\r\n  }\r\n\r\n  private addTouchEventListeners(): void {\r\n    this.removeAllEventListeners();\r\n    document.addEventListener('touchstart', (event: TouchEvent) => {\r\n      event.preventDefault();\r\n      this.setStartOrEndPoint(\r\n        event.touches[0].clientX,\r\n        event.touches[0].clientY,\r\n        'red'\r\n      );\r\n    });\r\n\r\n    document.addEventListener('touchmove', (event: TouchEvent) => {\r\n      event.preventDefault();\r\n      console.log('touchmove');\r\n      this.drawOnCanvas(\r\n        event.touches[0].clientX,\r\n        event.touches[0].clientY,\r\n        'green'\r\n      );\r\n    });\r\n\r\n    document.addEventListener('touchend', (event: TouchEvent) => {\r\n      this.setStartOrEndPoint(\r\n        this.lastCoordinates.lastX,\r\n        this.lastCoordinates.lastY,\r\n        'blue'\r\n      );\r\n    });\r\n  }\r\n\r\n  private removeAllEventListeners(): void {\r\n    document.removeAllListeners();\r\n  }\r\n\r\n  private setStartOrEndPoint(x: number, y: number, color: string) {\r\n    this.canvas2d.fillStyle = color;\r\n    this.canvas2d.fillRect(x, y, 3, 3);\r\n    this.lastCoordinates = { lastX: x, lastY: y };\r\n  }\r\n\r\n  private drawOnCanvas(x: number, y: number, color: string) {\r\n    this.canvas2d.beginPath();\r\n    this.canvas2d.moveTo(\r\n      this.lastCoordinates.lastX,\r\n      this.lastCoordinates.lastY\r\n    );\r\n    this.canvas2d.lineTo(x, y);\r\n    this.canvas2d.strokeStyle = '#000000';\r\n    this.canvas2d.stroke();\r\n\r\n    this.lastCoordinates = { lastX: x, lastY: y };\r\n  }\r\n}\r\n","<button (click)=\"activeEventType$$.next(EventType.PointerEvent)\">\r\n  PointerEvents\r\n</button>\r\n<button (click)=\"activeEventType$$.next(EventType.TouchEvent)\">\r\n  TouchEvents\r\n</button>\r\n<br />\r\n<canvas id=\"Canvas\" style=\"border:1px solid grey;\"> </canvas>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}